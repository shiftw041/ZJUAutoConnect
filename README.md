# ZJUAutoConnect
自动化脚本检测网络状态并重连

## 环境准备
pip install selenium webdriver-manager

## 初始运行
1. 替换main.py中的YOUR_USERNAME和YOUR_PASSWORD为自己的账密（必要时还需更改LOGIN_URL）
2. 默认使用edge（可通过切换注释的方式自行切换到chrome）

## 调试
1. 检查元素ID(By.ID)：
    1. 深澜系统(Srun)初始ID：
       * 账号输入框：username
       * 密码输入框：password
       * 登录按钮：login-account
    2. 如果跑不通，请打开登录页面，按F12，用左上角的小箭头点击输入框和登录按钮，查看它们的id="..."是什么，修改代码里By.ID后面的字符串。
2. 无头模式 (--headless)：
    1. 代码里有一行options.add_argument("--headless")，意味着浏览器会在后台静默运行，用户不会看到弹窗。
    2. 调试建议：第一次运行如果报错，先把这行代码注释掉，这样可以查看浏览器自动弹出来填表单的过程，方便找出是哪一步卡住了。

## 开机自启动
使用Windows自带的任务计划程序设置开机自启动
1. Win键搜索“任务计划程序”并打开。
2. 创建任务：点击右侧的“创建基本任务...”。
3. 名称：输入“自动重连校园网”，下一步。
4. 触发器：选择“计算机启动时”或“当用户登录时”（建议选登录时），下一步。
5. 操作：选择“启动程序”，下一步。
6. 程序/脚本：
    1. 程序或脚本：填写 pythonw.exe 的完整路径。如果不确定在哪，可以在cmd里输入where pythonw查看。
    2. 添加参数：填写脚本文件名，例如srun_auto.py。
    3. 起始于：填写脚本所在的文件夹路径，例如 D:\Scripts\ (这步很关键，不填可能报错)。
7. 彻底隐藏且无弹窗
    1. 在任务列表里找到刚才创建的任务，双击它。
    2. 在“常规”选项卡下，勾选 “不管用户是否登录都要运行” 和 “使用最高权限运行”。
    3. 勾选 “隐藏”。

## Q&A

Q: 我怎么知道它有没有在运行？ 

A: 打开“任务管理器” -> “详细信息”选项卡，找找看有没有pythonw.exe这个进程。如果有，说明正在运行。


Q: 我想关闭它怎么办？ 

A: 因为没有窗口，你只能在“任务管理器”里找到pythonw.exe，右键点击“结束任务”。


Q: 脚本运行报错了怎么看日志？ 

A: 因为pythonw不显示窗口，报错也看不到。建议在开发阶段先手动测试运行，确认无误后再切到pythonw。或者在脚本里将日志功能的注释取消
